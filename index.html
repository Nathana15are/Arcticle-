<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>üì∞ Mon Journal</title>
<style>
* { box-sizing:border-box; margin:0; padding:0; }
body{font-family:'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background:linear-gradient(135deg,#f5f7fa,#c3cfe2); color:#333; line-height:1.6;}
header{position:sticky; top:0; background:rgba(255,255,255,0.8); backdrop-filter:blur(10px); display:flex; flex-direction:column; align-items:center; padding:20px; box-shadow:0 4px 20px rgba(0,0,0,0.1);}
header h1{font-size:2em; margin-bottom:10px;}
header .controls{display:flex; gap:10px; flex-wrap:wrap; justify-content:center;}
select, button{padding:8px 12px; border:none; border-radius:8px; cursor:pointer; font-size:1em; transition:0.3s;}
select{background:rgba(255,255,255,0.7);}
button{background:#222; color:#fff;}
button:hover{background:#444; transform:scale(1.05);}
#visitorCounter{margin-top:10px; font-size:1em;}
#articles{display:grid; grid-template-columns:repeat(auto-fit,minmax(280px,1fr)); gap:20px; padding:20px;}
.article{background:rgba(255,255,255,0.6); backdrop-filter:blur(10px); border-radius:15px; overflow:hidden; box-shadow:0 10px 30px rgba(0,0,0,0.1); transition:transform 0.3s;}
.article:hover{transform:translateY(-8px); box-shadow:0 15px 40px rgba(0,0,0,0.25);}
.article img{width:100%; height:180px; object-fit:cover;}
.article .text{padding:15px;}
.article h2{margin-bottom:10px;}
.article p{margin-bottom:10px;}
.article small{color:#555; font-size:0.85em;}
.theme-badge{display:inline-block; background:#ff6b6b; color:#fff; padding:3px 8px; border-radius:12px; font-size:0.75em; margin-bottom:5px; text-transform:uppercase;}
footer{text-align:center; padding:15px; background:rgba(255,255,255,0.8); backdrop-filter:blur(10px); color:#444; margin-top:20px;}
#adminPanel{display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.6); backdrop-filter:blur(5px); display:flex; justify-content:center; align-items:center; z-index:1000;}
#adminContent{background:#fff; padding:30px; border-radius:15px; width:90%; max-width:500px; max-height:90%; overflow-y:auto;}
#adminContent h2{margin-bottom:15px; text-align:center;}
#adminContent input, #adminContent textarea, #adminContent select, #adminContent button{width:100%; margin:10px 0; padding:10px; border-radius:8px; border:1px solid #ccc;}
#adminContent button{background:#222;color:#fff;}
#adminContent button:hover{background:#444; transform:scale(1.05);}
.articleItem{border:1px solid #ccc;padding:10px;margin-bottom:10px;border-radius:10px;background:white; display:flex; flex-direction:column; gap:5px;}
.articleItem img{width:100%; height:150px; object-fit:cover; border-radius:6px;}
.closeAdmin{background:red; margin-bottom:10px;}
@media(max-width:600px){
  header h1{font-size:1.6em;}
  .article img{height:150px;}
  #articles{grid-template-columns:1fr;}
}
</style>
</head>
<body>

<header>
<h1>üì∞ Mon Journal</h1>
<div class="controls">
<select id="sort"><option value="date">üìÖ Trier par date</option><option value="popularity">‚≠ê Trier par popularit√©</option></select>
<select id="filterTheme"><option value="all">Tous les th√®mes</option></select>
<button onclick="toggleAdmin()">Page Admin</button>
</div>
<div id="visitorCounter">Visites totales : 0</div>
</header>

<main id="articles"></main>
<footer>‚ú® Propuls√© par SheetDB ‚ú®</footer>

<div id="adminPanel">
<div id="adminContent">
<button class="closeAdmin" onclick="toggleAdmin()">Fermer X</button>
<h2>Connexion Admin</h2>
<div id="loginForm">
<input type="password" id="password" placeholder="Mot de passe">
<button onclick="checkPassword()">Se connecter</button>
</div>
<div id="adminPanelContent" style="display:none;">
<h2>Ajouter / Modifier Article</h2>
<input type="text" id="title" placeholder="Titre">
<textarea id="content" placeholder="Contenu"></textarea>
<input type="text" id="image" placeholder="URL image (optionnel)">
<input type="number" id="popularity" placeholder="Popularit√©">
<input type="date" id="date">
<input type="text" id="theme" placeholder="Th√®me">
<button onclick="addArticle()">Ajouter Article</button>
<h2>Articles existants</h2>
<div id="articlesList"></div>
</div>
</div>
</div>

<script>
const API_URL="https://sheetdb.io/api/v1/ki97uz4ffxzca";
const ADMIN_PASS="Marius2013.";

// VISITOR COUNTER
async function updateVisitorCounter(){
  const res = await fetch(`https://api.countapi.xyz/hit/mon_journal_site_123/visites`);
  const data = await res.json();
  document.getElementById("visitorCounter").textContent="Visites totales : "+data.value;
}
updateVisitorCounter();

// ARTICLES (exemple 10, tu peux ajouter tes 100)
let localArticles = [

];

// ADMIN PANEL
function toggleAdmin(){
  const panel=document.getElementById("adminPanel");
  panel.style.display = panel.style.display==="flex"?"none":"flex";
}

function checkPassword(){
  const pass=document.getElementById("password").value;
  if(pass===ADMIN_PASS){
    document.getElementById("loginForm").style.display="none";
    document.getElementById("adminPanelContent").style.display="block";
    displayArticles(localArticles);
    populateThemes();
  } else alert("Mot de passe incorrect");
}

// AFFICHAGE ARTICLES
function displayArticles(articles){
  const container=document.getElementById("articles");
  container.innerHTML="";
  const filter=document.getElementById("filterTheme").value;
  let filtered = articles;
  if(filter!=="all") filtered = articles.filter(a=>a.theme.toLowerCase()===filter.toLowerCase());
  const sort=document.getElementById("sort").value;
  if(sort==="popularity") filtered.sort((a,b)=>b.popularity-a.popularity);
  else filtered.sort((a,b)=>new Date(b.date)-new Date(a.date));
  filtered.forEach(a=>{
    const div=document.createElement("div");
    div.className="article";
    let imgHtml = a.image ? `<img src="${a.image}" alt="">` : "";
    div.innerHTML=`${imgHtml}<div class="text"><span class="theme-badge">${a.theme}</span><h2>${a.title}</h2><p>${a.content}</p><small>‚≠ê ${a.popularity} | üìÖ ${a.date}</small></div>`;
    container.appendChild(div);
  });
}

// ADMIN ACTIONS
function addArticle(){
  const title=document.getElementById("title").value;
  const content=document.getElementById("content").value;
  const image=document.getElementById("image").value;
  const popularity=document.getElementById("popularity").value;
  const date=document.getElementById("date").value;
  const theme=document.getElementById("theme").value;
  const newArticle={title,content,image,popularity:parseInt(popularity),date,theme};
  localArticles.push(newArticle);
  displayArticles(localArticles);
  populateThemes();
}

// FILTRES
function populateThemes(){
  const themeSelect=document.getElementById("filterTheme");
  const themes=[...new Set(localArticles.map(a=>a.theme))];
  themeSelect.innerHTML=`<option value="all">Tous les th√®mes</option>`+themes.map(t=>`<option value="${t}">${t}</option>`).join("");
}

document.getElementById("sort").addEventListener("change",()=>displayArticles(localArticles));
document.getElementById("filterTheme").addEventListener("change",()=>displayArticles(localArticles));

// INITIALISATION
displayArticles(localArticles);
populateThemes();
</script>
</body>
</html>
