<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>üêµ MonkeyGames - Quiz Jungle</title>
<style>
:root{
  --bg:#0a1e0f; --card:#123018; --accent:#8b5cf6; --muted:#c0c0b0; --glass: rgba(255,255,255,0.05);
  font-family: 'Segoe UI', Roboto, sans-serif;
}
*{box-sizing:border-box;margin:0;padding:0;}
body{background: linear-gradient(160deg,#0a1e0f,#123018); color:#e6eef8; overflow-x:hidden; position:relative;}
.particles{position:fixed;top:0;left:0;width:100%;height:100%;pointer-events:none;z-index:0;}
.particle{position:absolute; width:10px; height:10px; background:rgba(139,92,246,0.3); border-radius:50%; animation:fall linear infinite;}
@keyframes fall{0%{transform:translateY(-10px) rotate(0deg);}100%{transform:translateY(110vh) rotate(360deg);}}
.app{position:relative; z-index:1; min-height:100vh; display:flex; flex-direction:column; align-items:center; padding:20px; gap:20px;}
.header{width:100%; max-width:1200px; display:flex; justify-content:space-between; align-items:center;}
.logo{font-size:28px;font-weight:bold; color:var(--accent); text-shadow:0 0 15px var(--accent);}
.subtitle{font-size:12px;color:var(--muted);}
.container{display:flex; flex-direction:column; width:100%; max-width:1200px; gap:20px;}
.panel{background:var(--card); border-radius:12px; padding:16px; box-shadow: 0 8px 20px rgba(0,0,0,0.7); transition:0.3s; transform:translateY(0);}
.panel:hover{transform:translateY(-4px); box-shadow:0 12px 28px rgba(139,92,246,0.6);}
.grid{display:grid; grid-template-columns: repeat(auto-fit,minmax(160px,1fr)); gap:16px;}
.card{background:var(--glass); padding:12px; border-radius:10px; cursor:pointer; transition:0.3s; display:flex; flex-direction:column; gap:6px; border:1px solid rgba(139,92,246,0.2); opacity:0; transform:translateY(15px); animation:fadeInUp 0.6s ease forwards;}
.card:hover{transform:translateY(-6px) rotateZ(1deg); box-shadow:0 12px 28px rgba(139,92,246,0.8); border:1px solid var(--accent);}
.card h3{font-size:16px;}
.card p{font-size:12px;color:var(--muted);}
.card.flash{animation:flashNeon 0.3s;}
@keyframes flashNeon{0%{box-shadow:0 0 8px #8b5cf6; transform:scale(1.02);}50%{box-shadow:0 0 20px #8b5cf6; transform:scale(1.05);}100%{box-shadow:0 0 8px #8b5cf6; transform:scale(1);}}
.answer-btn{margin:4px 0; padding:6px 10px; border-radius:8px; border:none; background:rgba(255,255,255,0.1); color:#fff; cursor:pointer; transition:0.3s;}
.answer-btn:hover{background:var(--accent); transform:scale(1.05);}
.correct{background:green !important;}
.wrong{background:red !important;}
.btn{padding:8px 12px; border-radius:8px; background:linear-gradient(90deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01)); border:1px solid rgba(139,92,246,0.5); color:inherit; cursor:pointer; transition:0.3s;}
.btn:hover{box-shadow:0 0 12px var(--accent); transform:scale(1.05);}
.footer{text-align:center;color:var(--muted); font-size:12px; display:flex; justify-content:center; align-items:center; gap:10px; flex-direction:column;}
.admin-panel{position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.85);display:none;align-items:center;justify-content:center;z-index:1000; animation:fadeIn 0.3s;}
.admin-content{background:var(--card); padding:20px; border-radius:12px; max-width:500px; width:90%; max-height:90%; overflow:auto; box-shadow:0 0 20px rgba(139,92,246,0.7);}
.admin-content h3{color:var(--accent); text-align:center; text-shadow:0 0 6px var(--accent);}
.close-btn{margin-top:10px;background:var(--accent); color:#fff; cursor:pointer; transition:0.3s;}
.close-btn:hover{box-shadow:0 0 12px var(--accent); transform:scale(1.05);}
#monkeySoundBtn{margin-top:10px; background:#ffeb3b; color:#000; font-weight:bold;}
@keyframes fadeInUp{0%{opacity:0; transform:translateY(20px);}100%{opacity:1; transform:translateY(0);}}
@keyframes fadeIn{from{opacity:0;} to{opacity:1;}}
</style>
</head>
<body>
<div class="particles" id="particles"></div>

<div class="app">
  <div class="header">
    <div>
      <div class="logo">üêµ MonkeyGames</div>
      <div class="subtitle">Quiz & Actualit√©s de la Jungle</div>
    </div>
    <button class="btn" id="adminBtn">Admin</button>
  </div>

  <div class="container">
    <div class="panel">
      <h2>üß† Quiz de la Jungle</h2>
      <div class="grid" id="quizList"></div>
    </div>

    <div class="panel">
      <h2>üì∞ Actualit√©s</h2>
      <div class="grid" id="newsList"></div>
    </div>
  </div>

  <div class="footer">
    ¬© 2025 MonkeyGames
    <button class="btn" id="monkeySoundBtn">üéµ Cri de singe</button>
  </div>
</div>

<div class="admin-panel" id="adminPanel">
  <div class="admin-content">
    <h3>Admin (Modifier/Supprimer)</h3>
    <input type="password" id="adminPass" placeholder="Mot de passe">
    <button class="btn" id="loginBtn">Se connecter</button>
    <div id="adminForms" style="display:none;">
      <p>Admin activ√© uniquement pour modification/suppression des √©l√©ments s√©lectionn√©s.</p>
    </div>
    <button class="btn close-btn" id="closeAdmin">Fermer</button>
  </div>
</div>

<audio id="clickSound" src="https://assets.codepen.io/605876/click-neon.mp3"></audio>
<audio id="suspenseSound" src="https://assets.codepen.io/605876/suspense-loop.mp3" loop autoplay></audio>
<audio id="monkeySound" src="https://assets.codepen.io/605876/monkey-cry.mp3"></audio>

<script>
const SHEET_URL="https://sheetdb.io/api/v1/lmifyr403m3ox";
const ADMIN_PASS="Marius2013.";

async function loadData(){
  const res=await fetch(SHEET_URL);
  const data=await res.json();
  const quizList=document.getElementById("quizList");
  const newsList=document.getElementById("newsList");
  quizList.innerHTML=""; newsList.innerHTML="";
  data.forEach((row,i)=>{
    if(row.type==="quiz"){
      const card=document.createElement("div");
      card.className="card";
      card.style.animationDelay=`${i*0.1}s`;
      card.innerHTML=`<h3>${row.nom}</h3><p>${row.question}</p>`;
      card.onclick=()=>showQuiz(card,row);
      quizList.appendChild(card);
    }else if(row.type==="news"){
      const card=document.createElement("div");
      card.className="card";
      card.style.animationDelay=`${i*0.1}s`;
      card.innerHTML=`<h3>${row.titre}</h3><p>${row.contenu}</p>`;
      card.onclick=()=>selectCard(card,row);
      newsList.appendChild(card);
    }
  });
}

function showQuiz(card,row){
  document.getElementById("clickSound").play();
  card.classList.add("flash");
  setTimeout(()=>card.classList.remove("flash"),300);
  // cr√©e les boutons r√©ponses
  if(card.querySelector(".answers")) return; // √©vite duplication
  const answersContainer=document.createElement("div");
  answersContainer.className="answers";
  ["r1","r2","r3"].forEach(r=>{
    const btn=document.createElement("button");
    btn.className="answer-btn";
    btn.textContent=row[r];
    btn.onclick=()=>checkAnswer(btn,row.bonne);
    answersContainer.appendChild(btn);
  });
  card.appendChild(answersContainer);
}

function checkAnswer(btn,good){
  if(btn.textContent===good) btn.classList.add("correct");
  else btn.classList.add("wrong");
}

function selectCard(card,row){
  if(document.getElementById("adminForms").style.display==="block"){
    const pass=prompt("Mot de passe admin requis :");
    if(pass!==ADMIN_PASS)return alert("Mot de passe incorrect !");
    const action=confirm("OK = Modifier, Annuler = Supprimer ?");
    if(action){
      const newValue=prompt("√âdite ton contenu :", row.question||row.contenu);
      if(newValue){
        let updated=row;
        if(row.type==="quiz") updated.question=newValue;
        else updated.contenu=newValue;
        fetch(`${SHEET_URL}/id/${row.id}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(updated)}).then(()=>loadData());
      }
    }else{
      if(confirm("Supprimer d√©finitivement ?")){
        fetch(`${SHEET_URL}/id/${row.id}`,{method:"DELETE"}).then(()=>loadData());
      }
    }
  }
}

document.getElementById("adminBtn").onclick=()=>document.getElementById("adminPanel").style.display="flex";
document.getElementById("closeAdmin").onclick=()=>document.getElementById("adminPanel").style.display="none";
document.getElementById("loginBtn").onclick=()=>{
  const val=document.getElementById("adminPass").value;
  if(val===ADMIN_PASS) document.getElementById("adminForms").style.display="block";
  else alert("Mot de passe incorrect üü•");
};
document.getElementById("monkeySoundBtn").onclick=()=>document.getElementById("monkeySound").play();

function createParticles(){
  for(let i=0;i<50;i++){
    const p=document.createElement("div");
    p.className="particle";
    p.style.left=Math.random()*100+"%";
    p.style.animationDuration=(3+Math.random()*5)+"s";
    p.style.width=(5+Math.random()*10)+"px";
    p.style.height=p.style.width;
    document.getElementById("particles").appendChild(p);
  }
}
createParticles();
loadData();
</script>
</body>
</html>
